<head>
  <title>Session Planner</title>
</head>

<body>
  {{> page}}
</body>

<template name="page">
  {{#if showCreateDialog}}
    {{> createDialog}}
  {{/if}}
  {{#if showInviteDialog}}
    {{> inviteDialog}}
  {{/if}}
  {{#constant}}
  <div class="navbar navbar-top">
    <div class="navbar-inner">
      <div class="container">
        <ul class="nav">
          <li class="active">
            <a class="brand" href="/">SessionPlanner</a>
          </li>
          <li><a href="/">Liste </a></li>
          <li><a href="#" class="create-session">Création</a></li>
          <li>
            <input name="search" id="search" value="{{search_keywords}}" type="text" class="search-query" placeholder="Search">
          </li>
        </ul>
        <div class="pull-right">
          {{loginButtons align="right"}}
        </div>
      </div>
    </div>
  </div>
  {{/constant}}
  <div class="container-fluid">
    <sidebar class="span4 liste_sessions">
      {{> sidebar}}
    </sidebar>
    <div class="span8 details_session">
      {{> details}}
    </div>
  </div>
</template>

<template name="sidebar">
  {{> sessions_headers}}
</template>

<template name="sessions_headers">
  {{#each sessions}}
    <div class="session_header list-group {{selected}}">
      <h4 class="list-group-item-heading {{open}}">{{nom}} by {{showUsername owner}}</h4>
      <p class="list-group-item-text">{{momentDate date}}</p>
    </div>
  {{/each}}
</template>

<template name="details">
  {{#if session}}
    {{#with session}}
      {{#if session_owner}}
        {{> admin_session}}
      {{/if}}
      <h2>{{nom}}</h2>
      <h4>à {{lieu}}</h4>
      <p>{{description}}</p>
      <p>places restantes : {{nb_participants_confirmes}}/{{nb_places}}</p>
      {{#each_sorted participants}}
        <i class="icon-{{rsvp_icon rsvp}} icon-large pull-left"></i>
        <p>{{showUsername user}}</p>
        {{#if is_invited}}
          <span class="label label-info pull-right">Invité</span>
        {{/if}}
      {{/each_sorted}}
    {{/with}}
      {{#if currentUser}}
        <input type="button" value="I'm going!"
               class="btn btn-small rsvp_yes {{maybeChosen "yes"}}">
        <input type="button" value="Maybe"
               class="btn btn-small rsvp_maybe {{maybeChosen "maybe"}}">
        <input type="button" value="No"
               class="btn btn-small rsvp_no {{maybeChosen "no"}}">
      {{else}}
        <i>Sign in to RSVP for this party.</i>
      {{/if}}
  {{/if}}
</template>

<template name="admin_session">
  <button class="delete-btn btn btn-danger">
    Delete
  </button>
  <button class="invite-btn btn btn-primary">
    Invite
  </button>
</template>

<template name="createDialog">
  <div class="mask"> </div>
  <div class="modal">
    <div class="modal-header">
      <button type="button" class="close cancel">&times;</button>
      <h3>Add session</h3>
    </div>

    <div class="modal-body">
      {{#if error}}
        <div class="alert alert-error">{{error}}</div>
      {{/if}}

      <label>Nom</label>
      <input type="text" class="nom span5">

      <label>Date</label>
      <input type="datetime-local" class="date span5">

      <label>Lieu</label>
      <input type="text" class="lieu span5">

      <label class="checkbox">
        <input type="checkbox" class="open">
        Private session &mdash; invitees only
      </label>

      <label>Nombre de places</label>
      <input type="number" class="nb_places span5" min="0">

      <label>Description</label>
      <textarea class="description span5"></textarea>
    </div>

    <div class="modal-footer">
      <a href="#" class="btn cancel">Cancel</a>
      <a href="#" class="btn btn-primary save">Add session</a>
    </div>
  </div>
</template>

<template name="inviteDialog">
  <div class="mask"> </div>
  <div class="modal">
    <div class="modal-header">
      <button type="button" class="close done">&times;</button>
      <h3>Invite des sacs</h3>
    </div>

    <div class="modal-body">
      {{#each uninvited}}
        <div class="invite-row">
          <a href="#" class="btn invite">Invite</a>
          {{username}}
        </div>
      {{else}}
        Everyone on the site has already been invited.
      {{/each}}
    </div>

    <div class="modal-footer">
      <a href="#" class="btn btn-primary done">Done</a>
    </div>
  </div>
</template>
